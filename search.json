[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "pblog",
    "section": "",
    "text": "Getting Started with Accessible Highcharter\n\n\n\n\n\n\ncode\n\n\naccessibility\n\n\ngraphics\n\n\nr\n\n\n\n\n\n\n\n\n\nDec 16, 2024\n\n\nPaul Smith\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/01-highcharter/index.html",
    "href": "posts/01-highcharter/index.html",
    "title": "Getting Started with Accessible Highcharter",
    "section": "",
    "text": "Inspired by the quarto and me blog, I am looking into using {highcharter} (Kunst 2022). This package is a wrapper for Highcharts – an interactive charting library1.\n\nKunst, Joshua. 2022. Highcharter: A Wrapper for the ’Highcharts’ Library. https://CRAN.R-project.org/package=highcharter.\n1 this needs a license for commercial and governmental useIn this post I will only be considering a scatter graph. Different plots – including survival curves – will come later.\n\n\n\nMy main requirements are mostly subjective:\n\nLooks nice\nIs interactive in a nice and obvious way\nIs accessible, following advice given by the Government Analysis Function"
  },
  {
    "objectID": "posts/01-highcharter/index.html#introduction",
    "href": "posts/01-highcharter/index.html#introduction",
    "title": "Getting Started with Accessible Highcharter",
    "section": "",
    "text": "Inspired by the quarto and me blog, I am looking into using {highcharter} (Kunst 2022). This package is a wrapper for Highcharts – an interactive charting library1.\n\nKunst, Joshua. 2022. Highcharter: A Wrapper for the ’Highcharts’ Library. https://CRAN.R-project.org/package=highcharter.\n1 this needs a license for commercial and governmental useIn this post I will only be considering a scatter graph. Different plots – including survival curves – will come later.\n\n\n\nMy main requirements are mostly subjective:\n\nLooks nice\nIs interactive in a nice and obvious way\nIs accessible, following advice given by the Government Analysis Function"
  },
  {
    "objectID": "posts/01-highcharter/index.html#getting-started-with-highcharter",
    "href": "posts/01-highcharter/index.html#getting-started-with-highcharter",
    "title": "Getting Started with Accessible Highcharter",
    "section": "Getting started with {highcharter}",
    "text": "Getting started with {highcharter}\nLets use the {palmerpenguins} data2 (Horst, Hill, and Gorman 2020).\n2 because penguins are nicer than eugenicists\nHorst, Allison Marie, Alison Presmanes Hill, and Kristen B Gorman. 2020. Palmerpenguins: Palmer Archipelago (Antarctica) Penguin Data. https://doi.org/10.5281/zenodo.3960218.\nThis is also the first time I have used the base R pipe |&gt;, after a life-time (well, 5 years) of using %&gt;%. The differences between the two are explain in this tidyverse blog. This means that the below code will not work on R versions prior to 4.1.0.\n\n\nCode\nlibrary(highcharter)\nlibrary(palmerpenguins)\n\n#data(package = 'palmerpenguins')\n\npenguins\n\n\n\n  \n\n\n\nA basic scatter graph, using the hchart function. Here, hcaes is similar in spirit to ggplot’s aes.\n\n\nCode\nhchart(penguins,\"scatter\", \n       hcaes(x = flipper_length_mm, y = bill_length_mm, group = species))\n\n\n\n\n\n\n\n\n\n\nSimple changes\nLets change a few things about the plot:\n\nAdd \\(x\\) and \\(y\\) axis labels;\nAdd a title and subtitle;\nAdd a source;\nChange the colours to the Government Analysis Function categorical data colour palette;\nMake the hover box specify ‘flipper length’ and ‘bill length’.\n\n\n\n\n\n\nGovernment analysis function colour palette\n\n\n\n\nCode\nhc_penguins &lt;- hchart(penguins,\"scatter\", \n       hcaes(x = flipper_length_mm, y = bill_length_mm, group = species)) |&gt;\n  # x axis label\n  hc_xAxis(title = list(text = \"Flipper Length (mm)\")) |&gt;\n  # y axis label\n  hc_yAxis(title = list(text = \"Bill Length (mm)\")) |&gt;\n  # title and subtitle\n  hc_title(text = \"Gentoo's have &lt;i&gt;big&lt;/i&gt; flippers!\",\n           margin = 20, # space between title (or subtitle) and plot [default = 15]\n           align = \"left\",\n           stlyle = list(useHTML = TRUE)) |&gt;\n  hc_subtitle(text = \"A scatter graph showing the relationship between flipper length \n              and bill length, for Adelie, Chinstrap and Gentoo penguins\",\n              align = \"left\") |&gt;\n  # a source\n hc_credits(\n    text = \"Chart created using R and highcharter\",\n    href = \"http://jkunst.com/highcharter\",\n    enabled = TRUE\n    ) |&gt;\n  # hover box options\n  hc_tooltip(\n    headerFormat = \"&lt;b&gt;{series.name}&lt;/b&gt;&lt;br&gt;\",\n    pointFormat = \"Flipper Length: {point.x} mm&lt;br&gt;Bill Length: {point.y} mm\"\n    #&gt; valueSuffix applies globally but only when values are displayed individually\n    #&gt; here, displayed twice so hard-coded into 'pointFormat'\n    #&gt;valueSuffix = \" mm\"\n  ) |&gt;\n  hc_colors(c(\"#12436D\", \"#28A197\", \"#801650\"))\n  \nhc_penguins"
  },
  {
    "objectID": "posts/01-highcharter/index.html#adding-accessibility",
    "href": "posts/01-highcharter/index.html#adding-accessibility",
    "title": "Getting Started with Accessible Highcharter",
    "section": "Adding accessibility",
    "text": "Adding accessibility\nHere we assume the visually aspects of the graph are accessible.3 In this section I will add the following capabilities to the graph.\n3 This is probably a big assumption. I am assuming the following information given by the Government Analysis Function (which apply to static charts) has been applied:\n\nGuidance on designing charts.\nGuidance on the use of colour. For alternative colour palettes, consider Paul Tol’s notes\n\n\nThe ability to download the data;\nKeyboard navigation;\nAlt text, following guidance given by Amy Cesal in her blog post, “Writing Alt Text for Data Visualization”.\n\n\nExporting the data\nFirst, lets try and include a menu to export the data and the plot as an image – this requires using a module. Examples of using modules and plug-ins4 in {highcharter} are given in the modules vignette.\n4 I’m not sure what the difference is between a ‘module’ and a ‘plug-in’, except that the ‘.js’ files seem to live in different folders.\n\nCode\nhc_penguins2 &lt;- hc_penguins |&gt;\n  #hc_add_dependency(name = \"modules/exporting.js\") |&gt; \n  #hc_add_dependency(name = \"modules/export-data.js\") |&gt; \n  hc_exporting(\n    enabled = TRUE,\n    filename = \"palmer_penguins\"\n  )\n\nhc_penguins2\n\n\n\n\n\n\n\n\n\n\n\n\nComment on hc_add_dependency\n\n\n\nIn the quartoandme blog, the following lines are included in the ‘working example’:\n  hc_add_dependency(name = \"modules/accessibility.js\") |&gt; \n  hc_add_dependency(name = \"modules/exporting.js\") |&gt; \n  hc_exporting(\n    enabled = TRUE\n  )\nBut, (I think) the hc_exporting() function automatically includes the exporting.js and export-data.js modules when enabled = TRUE, so the two hc_add_dependency calls are unnecessary. I’m willing to be proved wrong here.\n\n\n\n\nKeyboard navigation\nTo get keyboard navigation working, we need to use the accessibility Highchart module.\n\n\n\n\n\n\nRequired changes to {highcharter} v0.9.4\n\n\n\nIf using v0.9.4 of {highcharter}, then copying the code below will result in no plot being output. This is a known issue, and is discussed in the GitHub repo issue 755.\nThere are two ways to fix this issue:\n\nUncomment the accessibility module in the ‘highcharts.yaml’ file.5 On my Mac, this is found at /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/highcharter/htmlwidgets (for your computer, use .libPaths() to find the default path for packages). The line\n\n    # - modules/accessibility.js\n    needs to be edited to be\n    - modules/accessibility.js\n    before loading the package into R.\n\nInstall an older version of {highcharter}, for example,6\n\nremotes::install_github(\"jbkunst/highcharter@8ff41366c8c411b497b5378d27be48617360f81f\")\n\n\n6 taken from mfherman’s reply to GitHub issue 755.5 Discussed by batpigandme in their reply to GitHub issue 755.\n\nCode\nhc_penguins3 &lt;- hc_penguins |&gt;\n  #hc_add_dependency(name = \"modules/exporting.js\") |&gt; \n  #hc_add_dependency(name = \"modules/export-data.js\") |&gt; \n  hc_add_dependency(name = \"modules/accessibility.js\") |&gt; \n  hc_exporting(\n    accessibility = list(\n      enabled = FALSE # default value is TRUE\n      ),\n    enabled = TRUE,\n    filename = \"palmer_penguins\"\n  ) |&gt;\n  hc_plotOptions(\n    accessibility = list(\n      enabled = TRUE,\n      keyboardNavigation = list(enabled = TRUE)\n      )\n    )\n\nhc_penguins3\n\n\n\n\n\n\n\n\nAlt text\n\n\n\n\n\nExample alt-text format for data viz, from Amy Cesal’s Medium post\n\n\nIn this section we add alt-text to the plot, to allow those using screen readers to understand the plot. )\nFirst, lets add accessible descriptions to the plot, by enabling the accessibility options in hc_xAxis and hc_yAxis.\n\n\nCode\nhc_penguins4 &lt;- hchart(penguins,\"scatter\", \n       hcaes(x = flipper_length_mm, y = bill_length_mm, group = species)) |&gt;\n  hc_add_dependency(name = \"modules/accessibility.js\") |&gt; \n  # x axis label\n  hc_xAxis(title = list(text = \"Flipper Length (mm)\"),\n           accessibility = list(\n                   enabled = TRUE,\n                   description = \"flipper length in millimeters\"\n           )) |&gt;\n  # y axis label\n  hc_yAxis(title = list(text = \"Bill Length (mm)\"),\n           accessibility = list(\n                   enabled = TRUE,\n                   description = \"bill length in millimeters\"\n           )) |&gt;\n  # title and subtitle\n  hc_title(text = \"Gentoo's have &lt;i&gt;big&lt;/i&gt; flippers!\",\n           margin = 20, # space between title (or subtitle) and plot [default = 15]\n           align = \"left\",\n           stlyle = list(useHTML = TRUE)) |&gt;\n  hc_subtitle(text = \"A scatter graph showing the relationship between flipper length \n              and bill length, for Adelie, Chinstrap and Gentoo penguins\",\n              align = \"left\") |&gt;\n  # a source\n hc_credits(\n    text = \"Chart created using R and highcharter\",\n    href = \"http://jkunst.com/highcharter\",\n    enabled = TRUE\n    ) |&gt;\n  # hover box options\n  hc_tooltip(\n    headerFormat = \"&lt;b&gt;{series.name}&lt;/b&gt;&lt;br&gt;\",\n    pointFormat = \"Flipper Length: {point.x} mm&lt;br&gt;Bill Length: {point.y} mm\"\n    #&gt; valueSuffix applies globally but only when values are displayed individually\n    #&gt; here, displayed twice so hard-coded into 'pointFormat'\n    #&gt;valueSuffix = \" mm\"\n  ) |&gt;\n  hc_colors(c(\"#12436D\", \"#28A197\", \"#801650\")) |&gt;\n  hc_exporting(\n    accessibility = list(\n      enabled = FALSE # default value is TRUE\n      ),\n    enabled = TRUE,\n    filename = \"palmer_penguins\"\n  ) |&gt;\n  hc_plotOptions(\n    accessibility = list(\n      enabled = TRUE,\n      keyboardNavigation = list(enabled = TRUE)\n      )\n    )\n  \nhc_penguins4\n\n\n\n\n\n\nNote that the desciption in hc_xAxis and hc_yAxis does not start with a capital letter. The reason why is clear from looking at the html output below. Here, aria-hidden=\"false\" refers to Accessible Rich Internet Applications, and is telling screen readers not to ignore this section.\n&lt;div id=\"highcharts-screen-reader-region-before-4\"\naria-label=\"Chart screen reader information, Gentoo's have big flippers!.\"\nstyle=\"position: relative;\" role=\"region\" aria-hidden=\"false\"&gt;\n...\n&lt;h4&gt;Gentoo's have big flippers!&lt;/h4&gt;\n&lt;div&gt;Scatter chart with 3 data series.&lt;/div&gt;\n...\n&lt;div&gt;The chart has 1 X axis displaying flipper length in millimeters. Range: 171.41 to 231.59.&lt;/div&gt;\n&lt;div&gt;The chart has 1 Y axis displaying bill length in millimeters. Range: 30 to 65.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\nThe alt-text is saved as a string to the alt_text_penguins object.\n\n\nCode\nalt_text_penguins &lt;- \"A scatter plot displays the relationship between bill\n        length (mm) on the y-axis and flipper length (mm) on the x-axis for\n        three penguin species: Adelie, Chinstrap, and Gentoo. Each species is\n        represented by a different colour: dark blue for Adelie, teal for Chinstrap,\n        and burgundy for Gentoo. Gentoo penguins have the largest flipper and bill\n        lengths, forming a distinct cluster towards the upper right of the graph.\n        Adelie penguins have smaller flipper and bill lengths, clustering at the lower\n        left, while Chinstrap penguins are positioned between the other two species.\n        The chart highlights that Gentoo penguins have notably large flippers.\"\n\n\n\nUsing Highchart sccessibility desciption\nThe simple way to include this alt-text in the plot would be to use the hc_chart() function with the accessibility.description option set to equal alt_text_penguins. But, as discussed in the Highcharts accessibility documentation,\n\nNote: Since Highcharts now supports captions and linked descriptions, it is preferred to define the description using those methods, as a visible caption/description benefits all users. If the accessibility.description option is defined, the linked description is ignored, and the caption is hidden from screen reader users.\n\n\n\nCode\nhc_penguins4 |&gt;\n  hc_chart(\n    accessibility = list(\n      description = alt_text_penguins\n    )\n  )\n\n\n\n\n\n\n\n\nUsing linkedDescription\nHere, we first define an external HTML element, where the &lt;div&gt; with an ID (chart-description) contains the description of the chart. Then, then the linkedDescription option in hc_chart(accessibility = ...) connects the chart to the &lt;div&gt; by its ID.\n\n\nIf accessibility.description is also defined in the chart, it will override the linked description, as mentioned in the documentation.\n\n\nCode\n# Add an external description for the chart\ndescription_id &lt;- \"chart-description\"\n\ncat(sprintf(\n  '&lt;div id=\"%s\"&gt;\n    A scatter plot displays the relationship between bill length (mm) on the y-axis \n    and flipper length (mm) on the x-axis for three penguin species: Adelie, Chinstrap, \n    and Gentoo. Each species is represented by a different colour: dark blue for Adelie, \n    teal for Chinstrap, and burgundy for Gentoo. Gentoo penguins have the largest flipper \n    and bill lengths, forming a distinct cluster towards the upper right of the graph. \n    Adelie penguins have smaller flipper and bill lengths, clustering at the lower left, \n    while Chinstrap penguins are positioned between the other two species. \n    The chart highlights that Gentoo penguins have notably large flippers.\n  &lt;/div&gt;',\n  description_id\n))\n\n\n&lt;div id=\"chart-description\"&gt;\n    A scatter plot displays the relationship between bill length (mm) on the y-axis \n    and flipper length (mm) on the x-axis for three penguin species: Adelie, Chinstrap, \n    and Gentoo. Each species is represented by a different colour: dark blue for Adelie, \n    teal for Chinstrap, and burgundy for Gentoo. Gentoo penguins have the largest flipper \n    and bill lengths, forming a distinct cluster towards the upper right of the graph. \n    Adelie penguins have smaller flipper and bill lengths, clustering at the lower left, \n    while Chinstrap penguins are positioned between the other two species. \n    The chart highlights that Gentoo penguins have notably large flippers.\n  &lt;/div&gt;\n\n\n\n\nCode\nhc_penguins4 |&gt;\n  hc_chart(\n    accessibility = list(\n      linkedDescription = description_id\n    )\n  )"
  }
]